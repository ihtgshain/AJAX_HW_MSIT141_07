
@{
    ViewData["Title"] = "Address";
}

<h1>地址</h1>
<select id="selCity" style="min-width:10rem"></select>
<select id="selDistrict" style="min-width:10rem"></select>
<select id="selRoad" style="min-width:10rem"></select>

@section Scripts{
    <script>
    const selCity = document.querySelector('#selCity');
    const selDistrict = document.querySelector('#selDistrict');
    const selRoad = document.querySelector('#selRoad');
    const xhr = new XMLHttpRequest();
    xhr.addEventListener('load', () => {
        const datas = JSON.parse(xhr.responseText);
        datas.forEach((city) => {
            const opt = new Option(city, city);
            selCity.options.add(opt);
        })
    });
    xhr.open("GET","@Url.Content("~/api/city")");
    xhr.send();

    selCity.addEventListener('change', () => {
        let target = selCity.options[selCity.selectedIndex].value;
        xhr.addEventListener('load', () => {
            selDistrict.innerHTML = "";
            const datas = JSON.parse(xhr.responseText);
            datas.forEach((district) => {
                const opt = new Option(district, district);
                selDistrict.options.add(opt);
            })
        })
        xhr.open("GET","@Url.Content("~/api/district")"+`?city=${target}`);
        xhr.send();
    });

    selDistrict.addEventListener('change', () => {
        let target = selDistrict.options[selDistrict.selectedIndex].value;
        xhr.addEventListener('load', () => {
        selRoad.innerHTML = "";
        const datas = JSON.parse(xhr.responseText);
        datas.forEach((Road) => {
            const opt = new Option(Road, Road);
            selRoad.options.add(opt);
        })
    })
    xhr.open("GET","@Url.Content("~/api/Road")"+`?district=${target}`);
    xhr.send();
});



    </script>
}